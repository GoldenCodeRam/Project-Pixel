var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function s(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){t.appendChild(e)}function r(t,e,n){t.insertBefore(e,n||null)}function l(t){t.parentNode.removeChild(t)}function a(t){return document.createElement(t)}function u(){return t=" ",document.createTextNode(t);var t}function h(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function d(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function f(t,e){t.value=null==e?"":e}function p(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}let m;function x(t){m=t}function g(){if(!m)throw new Error("Function called outside component initialization");return m}const $=[],v=[],_=[],y=[],w=Promise.resolve();let b=!1;function P(t){_.push(t)}let C=!1;const E=new Set;function M(){if(!C){C=!0;do{for(let t=0;t<$.length;t+=1){const e=$[t];x(e),k(e.$$)}for(x(null),$.length=0;v.length;)v.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];E.has(e)||(E.add(e),e())}_.length=0}while($.length);for(;y.length;)y.pop()();b=!1,C=!1,E.clear()}}function k(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(P)}}const z=new Set;function j(t,e){t&&t.i&&(z.delete(t),t.i(e))}function A(t,n,i,c){const{fragment:r,on_mount:l,on_destroy:a,after_update:u}=t.$$;r&&r.m(n,i),c||P((()=>{const n=l.map(e).filter(s);a?a.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(P)}function H(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function S(t,e){-1===t.$$.dirty[0]&&($.push(t),b||(b=!0,w.then(M)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function I(e,s,i,c,r,a,u=[-1]){const h=m;x(e);const d=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:r,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:s.context||[]),callbacks:n(),dirty:u,skip_bound:!1};let f=!1;if(d.ctx=i?i(e,s.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return d.ctx&&r(d.ctx[t],d.ctx[t]=s)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](s),f&&S(e,t)),n})):[],d.update(),f=!0,o(d.before_update),d.fragment=!!c&&c(d.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);d.fragment&&d.fragment.l(t),t.forEach(l)}else d.fragment&&d.fragment.c();s.intro&&j(e.$$.fragment),A(e,s.target,s.anchor,s.customElement),M()}x(h)}class L{$destroy(){H(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const O=10;class q{constructor(t,e,n){this._mousePosition={x:0,y:0},this._pixelObj={pixelX:0,pixelY:0,pixelColor:""},this._canvas=t,this._mousePositionText=e,this._context=t.getContext("2d"),this._data=[...Array(t.width)].map((e=>Array(t.height).fill([255,255,255,255]))),t.addEventListener("click",(t=>{n=this._pixelColor,this.mouseMovedInCanvas(t),this.draw(this._mousePosition.x,this._mousePosition.y,n),this._publicMousePosition={x:this._mousePosition.x,y:this._mousePosition.y}})),t.addEventListener("mousemove",(t=>{this.mouseMovedInCanvas(t),this._mousePositionText.textContent=`x: ${this._mousePosition.x}, y: ${this._mousePosition.y}`})),this.loadImage()}savePixel(t){return this._pixelObj={pixelX:this._publicMousePosition.x,pixelY:this._publicMousePosition.y,pixelColor:t}}loadImage(){const t=new Image;t.src="/images/cat2.png";const e=this;t.onload=()=>{e._context.canvas.width=t.width,e._context.canvas.height=t.height,e._context.drawImage(t,0,0,t.width,t.height)}}draw(t,e,n){this.setColor(n),t>=0&&t<this._canvas.width&&e>=0&&e<this._canvas.height&&this._context.fillRect(t*O,e*O,O,O)}setColor(t){this._context.fillStyle=`rgba(${t[0]},${t[1]},${t[2]},${t[3]})`}mouseMovedInCanvas(t){const e=this._canvas.getBoundingClientRect();let n=t.clientX-e.left,o=t.clientY-e.top;n=Math.floor(this._canvas.width*n/this._canvas.clientWidth),o=Math.floor(this._canvas.height*o/this._canvas.clientHeight);const s=Math.floor(n/O),i=Math.floor(o/O);this._mousePosition={x:s,y:i}}}const N="http://localhost:8084";class R{serverStatus(){const t=new XMLHttpRequest;t.open("get",`${N}/status`),t.send()}sendPixel(t){const e=new XMLHttpRequest;e.open("post",`${N}/sendNewPixel`),e.setRequestHeader("Content-type","application/json"),e.send(JSON.stringify(t))}getPixels(){const t=new XMLHttpRequest;t.open("get",`${N}/getStoredPixels`),t.responseType="json",t.onload=function(){t.readyState===t.DONE&&200===t.status&&(console.log("Firmas"),console.log(t.response.values))},t.send()}}function X(e){let n,s,i,m,x,g,$,v,_,y,w,b,P,C,E,M,k;return{c(){n=a("main"),s=a("div"),i=a("p"),i.textContent="Select a color",m=u(),x=a("p"),x.textContent="x: 0, y: 0",g=u(),$=a("input"),v=u(),_=a("div"),y=a("div"),w=a("canvas"),b=u(),P=a("button"),P.textContent="Enviar solicitud para modificar",C=u(),E=a("button"),E.textContent="Actualizar obra",d(i,"class","svelte-1wzno3h"),d(x,"id","cursorPosition"),d(x,"class","svelte-1wzno3h"),d($,"type","color"),p($,"height","50px"),d(w,"width","300px"),d(w,"height","300px"),d(w,"class","svelte-1wzno3h"),p(y,"--theme-color",e[2]),d(y,"class","svelte-1wzno3h"),d(_,"class","svelte-1wzno3h"),d(P,"class","button buttonHover svelte-1wzno3h"),d(E,"class","button buttonHover svelte-1wzno3h"),d(s,"class","hero svelte-1wzno3h"),d(n,"id","test")},m(t,o){r(t,n,o),c(n,s),c(s,i),c(s,m),c(s,x),e[5](x),c(s,g),c(s,$),f($,e[2]),c(s,v),c(s,_),c(_,y),c(y,w),e[7](w),c(s,b),c(s,P),c(s,C),c(s,E),M||(k=[h($,"input",e[6]),h(P,"click",e[3]),h(E,"click",e[4])],M=!0)},p(t,[e]){4&e&&f($,t[2]),4&e&&p(y,"--theme-color",t[2])},i:t,o:t,d(t){t&&l(n),e[5](null),e[7](null),M=!1,o(k)}}}function T(t){let e=[];var n;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(t))return 3==(n=t.substring(1).split("")).length&&(n=[n[0],n[0],n[1],n[1],n[2],n[2]]),n="0x"+n.join(""),e.push(n>>16&255),e.push(n>>8&255),e.push(255&n),e.push(1),e;throw new Error("Bad Hex")}function B(t,e,n){let o,s,i,c="#5c3838",r=[];const l=new R;var a;return a=()=>{i=new q(o,s,r)},g().$$.on_mount.push(a),function(t){g().$$.after_update.push(t)}((()=>{r=T(c),i._pixelColor=r})),[o,s,c,function(){i&&(console.log(i.savePixel(T(c))),console.log(T(c)),console.log(c),l.sendPixel(i.savePixel(T(c))))},function(){i&&l.getPixels()},function(t){v[t?"unshift":"push"]((()=>{s=t,n(1,s)}))},function(){c=this.value,n(2,c)},function(t){v[t?"unshift":"push"]((()=>{o=t,n(0,o)}))}]}class F extends L{constructor(t){super(),I(this,t,B,X,i,{})}}function Y(e){let n,o,s,i,h;return i=new F({}),{c(){var t;n=a("main"),o=a("h1"),o.textContent="Project Pixel",s=u(),(t=i.$$.fragment)&&t.c(),d(o,"class","svelte-sq2aix"),d(n,"id","test")},m(t,e){r(t,n,e),c(n,o),c(n,s),A(i,n,null),h=!0},p:t,i(t){h||(j(i.$$.fragment,t),h=!0)},o(t){!function(t,e,n,o){if(t&&t.o){if(z.has(t))return;z.add(t),(void 0).c.push((()=>{z.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}(i.$$.fragment,t),h=!1},d(t){t&&l(n),H(i)}}}return new class extends L{constructor(t){super(),I(this,t,null,Y,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
